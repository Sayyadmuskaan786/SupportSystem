{"ast":null,"code":"var _jsxFileName = \"/home/muskaan/Desktop/Summer_Internship/new/src/components/Chat.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useRef } from 'react';\nimport SockJS from 'sockjs-client';\nimport { Client } from '@stomp/stompjs';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst Chat = ({\n  ticketId,\n  username,\n  token,\n  onClose\n}) => {\n  _s();\n  const [messages, setMessages] = useState([]);\n  const [input, setInput] = useState('');\n  const clientRef = useRef(null);\n  const messagesEndRef = useRef(null);\n  useEffect(() => {\n    // Connect to WebSocket server\n    const socket = new SockJS('http://localhost:8080/ws');\n    const client = new Client({\n      webSocketFactory: () => socket,\n      reconnectDelay: 5000,\n      debug: str => {\n        console.log(str);\n      },\n      onConnect: () => {\n        client.subscribe(`/topic/ticket.${ticketId}`, message => {\n          if (message.body) {\n            const msg = JSON.parse(message.body);\n            setMessages(prev => [...prev, msg]);\n          }\n        });\n      },\n      onStompError: frame => {\n        console.error('Broker reported error: ' + frame.headers['message']);\n        console.error('Additional details: ' + frame.body);\n      }\n    });\n    client.activate();\n    clientRef.current = client;\n    return () => {\n      client.deactivate();\n    };\n  }, [ticketId]);\n  useEffect(() => {\n    // Scroll to bottom on new message\n    if (messagesEndRef.current) {\n      messagesEndRef.current.scrollIntoView({\n        behavior: 'smooth'\n      });\n    }\n  }, [messages]);\n  const sendMessage = () => {\n    if (input.trim() === '') return;\n    const chatMessage = {\n      ticketId: ticketId,\n      sender: username,\n      content: input.trim(),\n      timestamp: new Date().toISOString()\n    };\n    clientRef.current.publish({\n      destination: '/app/chat.sendMessage',\n      body: JSON.stringify(chatMessage),\n      headers: {\n        Authorization: `Bearer ${token}`\n      }\n    });\n    setInput('');\n  };\n  const handleKeyPress = e => {\n    if (e.key === 'Enter') {\n      e.preventDefault();\n      sendMessage();\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"bg-white rounded-lg shadow-lg w-96 max-h-[80vh] flex flex-col\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex justify-between items-center p-4 border-b\",\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          className: \"text-lg font-semibold\",\n          children: [\"Chat - Ticket #\", ticketId]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 77,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: onClose,\n          className: \"text-gray-600 hover:text-gray-900\",\n          children: \"\\xD7\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 78,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 76,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex-grow overflow-y-auto p-4 space-y-2\",\n        children: [messages.map((msg, index) => /*#__PURE__*/_jsxDEV(\"div\", {\n          className: `p-2 rounded max-w-[80%] ${msg.sender === username ? 'bg-blue-500 text-white self-end' : 'bg-gray-200 text-gray-800 self-start'}`,\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"text-xs font-semibold\",\n            children: msg.sender\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 88,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: msg.content\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 89,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"text-xs text-right\",\n            children: new Date(msg.timestamp).toLocaleTimeString()\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 90,\n            columnNumber: 15\n          }, this)]\n        }, index, true, {\n          fileName: _jsxFileName,\n          lineNumber: 82,\n          columnNumber: 13\n        }, this)), /*#__PURE__*/_jsxDEV(\"div\", {\n          ref: messagesEndRef\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 93,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 80,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"p-4 border-t flex space-x-2\",\n        children: [/*#__PURE__*/_jsxDEV(\"textarea\", {\n          value: input,\n          onChange: e => setInput(e.target.value),\n          onKeyPress: handleKeyPress,\n          rows: 2,\n          className: \"flex-grow border rounded px-2 py-1 resize-none focus:outline-none focus:ring-2 focus:ring-blue-500\",\n          placeholder: \"Type your message...\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 96,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: sendMessage,\n          className: \"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 transition\",\n          children: \"Send\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 104,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 95,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 75,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 74,\n    columnNumber: 5\n  }, this);\n};\n_s(Chat, \"T6sSZUIPAhK8wz8F73/i631fCO8=\");\n_c = Chat;\nexport default Chat;\nvar _c;\n$RefreshReg$(_c, \"Chat\");","map":{"version":3,"names":["React","useState","useEffect","useRef","SockJS","Client","jsxDEV","_jsxDEV","Chat","ticketId","username","token","onClose","_s","messages","setMessages","input","setInput","clientRef","messagesEndRef","socket","client","webSocketFactory","reconnectDelay","debug","str","console","log","onConnect","subscribe","message","body","msg","JSON","parse","prev","onStompError","frame","error","headers","activate","current","deactivate","scrollIntoView","behavior","sendMessage","trim","chatMessage","sender","content","timestamp","Date","toISOString","publish","destination","stringify","Authorization","handleKeyPress","e","key","preventDefault","className","children","fileName","_jsxFileName","lineNumber","columnNumber","onClick","map","index","toLocaleTimeString","ref","value","onChange","target","onKeyPress","rows","placeholder","_c","$RefreshReg$"],"sources":["/home/muskaan/Desktop/Summer_Internship/new/src/components/Chat.js"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\nimport SockJS from 'sockjs-client';\nimport { Client } from '@stomp/stompjs';\n\nconst Chat = ({ ticketId, username, token, onClose }) => {\n  const [messages, setMessages] = useState([]);\n  const [input, setInput] = useState('');\n  const clientRef = useRef(null);\n  const messagesEndRef = useRef(null);\n\n  useEffect(() => {\n    // Connect to WebSocket server\n    const socket = new SockJS('http://localhost:8080/ws');\n    const client = new Client({\n      webSocketFactory: () => socket,\n      reconnectDelay: 5000,\n      debug: (str) => {\n        console.log(str);\n      },\n      onConnect: () => {\n        client.subscribe(`/topic/ticket.${ticketId}`, (message) => {\n          if (message.body) {\n            const msg = JSON.parse(message.body);\n            setMessages((prev) => [...prev, msg]);\n          }\n        });\n      },\n      onStompError: (frame) => {\n        console.error('Broker reported error: ' + frame.headers['message']);\n        console.error('Additional details: ' + frame.body);\n      },\n    });\n    client.activate();\n    clientRef.current = client;\n\n    return () => {\n      client.deactivate();\n    };\n  }, [ticketId]);\n\n  useEffect(() => {\n    // Scroll to bottom on new message\n    if (messagesEndRef.current) {\n      messagesEndRef.current.scrollIntoView({ behavior: 'smooth' });\n    }\n  }, [messages]);\n\n  const sendMessage = () => {\n    if (input.trim() === '') return;\n    const chatMessage = {\n      ticketId: ticketId,\n      sender: username,\n      content: input.trim(),\n      timestamp: new Date().toISOString(),\n    };\n    clientRef.current.publish({\n      destination: '/app/chat.sendMessage',\n      body: JSON.stringify(chatMessage),\n      headers: {\n        Authorization: `Bearer ${token}`,\n      },\n    });\n    setInput('');\n  };\n\n  const handleKeyPress = (e) => {\n    if (e.key === 'Enter') {\n      e.preventDefault();\n      sendMessage();\n    }\n  };\n\n  return (\n    <div className=\"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50\">\n      <div className=\"bg-white rounded-lg shadow-lg w-96 max-h-[80vh] flex flex-col\">\n        <div className=\"flex justify-between items-center p-4 border-b\">\n          <h2 className=\"text-lg font-semibold\">Chat - Ticket #{ticketId}</h2>\n          <button onClick={onClose} className=\"text-gray-600 hover:text-gray-900\">&times;</button>\n        </div>\n        <div className=\"flex-grow overflow-y-auto p-4 space-y-2\">\n          {messages.map((msg, index) => (\n            <div\n              key={index}\n              className={`p-2 rounded max-w-[80%] ${\n                msg.sender === username ? 'bg-blue-500 text-white self-end' : 'bg-gray-200 text-gray-800 self-start'\n              }`}\n            >\n              <div className=\"text-xs font-semibold\">{msg.sender}</div>\n              <div>{msg.content}</div>\n              <div className=\"text-xs text-right\">{new Date(msg.timestamp).toLocaleTimeString()}</div>\n            </div>\n          ))}\n          <div ref={messagesEndRef} />\n        </div>\n        <div className=\"p-4 border-t flex space-x-2\">\n          <textarea\n            value={input}\n            onChange={(e) => setInput(e.target.value)}\n            onKeyPress={handleKeyPress}\n            rows={2}\n            className=\"flex-grow border rounded px-2 py-1 resize-none focus:outline-none focus:ring-2 focus:ring-blue-500\"\n            placeholder=\"Type your message...\"\n          />\n          <button\n            onClick={sendMessage}\n            className=\"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 transition\"\n          >\n            Send\n          </button>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default Chat;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}